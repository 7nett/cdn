/**handles:yith_wcpb_bundle_frontend_add_to_cart**/
jQuery(function(t){t.fn.yith_bundle_form=function(){t(this).each(function(){var i=t(this),e=i.data("product-id"),n=i.data("per-item-pricing"),a=i.data("ajax-update-price"),r=i.find(".yith-wcpb-product-bundled-items .price"),c=i.closest(yith_wcpb_params.price_handler_parent).find(yith_wcpb_params.price_handler)||i.closest(yith_wcpb_params.price_handler_parent_alt).find(yith_wcpb_params.price_handler_alt),d=1==yith_wcpb_params.price_handler_only_first?c.not(r).first():c.not(r),o=i.closest("form").find("button[type=submit]"),s=i.find(".add-request-quote-button"),_=s.css("background-color"),p=i.find(".bundled_item_cart_content"),l=i.find("input.yith-wcpb-bundled-quantity"),u=i.find(".yith-wcpb-bundled-optional"),f=i.find(".variation_id"),h=i.find("input[name=yith_wcpb_wpml_client_currency]"),b=null,m=function(){var i=!1;p.each(function(){var e=t(this),n=!(e.find(".yith-wcpb-bundled-optional").length>0)||t(this).find(".yith-wcpb-bundled-optional").is(":checked"),a=e.find("select.yith-wcpb-select-for-variables");n?(a.each(function(){var e=t(this);void 0!=e.val()&&""!=e.val()||(i=!0)}),e.find(".variations").slideDown("fast"),e.find(".single_variation_wrap").slideDown("fast"),e.find(".out-of-stock").length>0&&(i=!0)):e.find(".yith-wcpb-bundled-optional").length>0&&(e.find(".quantity input.qty").removeAttr("max"),e.find(".single_variation_wrap").slideUp("fast"),e.find(".variations").slideUp("fast"),e.find(".variation_id").val(""),e.closest(".variations_form").find(".variations select").val(""))}),o.prop("disabled",i),i?(s.addClass("disabled"),s.css("background-color","#bbb")):(s.removeClass("disabled"),s.css("background-color",_))},g={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},y=function(){if(b&&b.abort(),1==a){d.block(g);var i=[],n=[],r=[];l.each(function(){i[t(this).data("item-id")-1]=t(this).val()}),u.each(function(){n[t(this).data("item-id")-1]=t(this).is(":checked")?1:0}),f.each(function(){r[t(this).data("item-id")-1]=t(this).val()});var c=h.length>0?h.val():"",o={bundle_id:e,array_qty:i,array_opt:n,array_var:r,yith_wcpb_wpml_client_currency:c,action:"yith_wcpb_get_bundle_total_price"};b=t.ajax({type:"POST",data:o,url:ajax_obj.ajaxurl,success:function(i){var e=d.find("ins .amount");e.length<1&&(e=d.find(".amount")),e.length<1&&(e=d),e=e.first(),e.html(i),d.html(e.html()),t(document).trigger("yith_wcpb_ajax_update_price_request"),d.unblock()}})}};i.on("yith_wcpb_update_price",function(){m(),y()}).trigger("yith_wcpb_update_price"),l.on("change",function(){0==t(this).parents(".bundled_item_cart_content").length&&i.trigger("yith_wcpb_update_price")}),u.on("click",function(){0==t(this).parents(".bundled_item_cart_content").length&&i.trigger("yith_wcpb_update_price")}),p.on("change",function(){i.trigger("yith_wcpb_update_price")}),p.on("found_variation",function(i,e){var n=t(this).closest(".product"),a=n.find(".yith-wcpb-product-bundled-item-image .price").first(),r=a.find("ins"),c=a.find("del"),d=n.find(".yith-wcpb-product-bundled-item-image-wrapper img").first(),o="";"undefined"!=typeof e.image_srcset&&e.image_srcset?o=e.image_srcset:"undefined"!=typeof e.image&&"undefined"!=typeof e.image.srcset&&e.image.srcset&&(o=e.image.srcset),o.length>0&&d.attr("srcset",o),r.html(e.price_html.replace("price","amount")),c.html(e.display_regular_price_html)}).on("reset_data",function(){var i=t(this).closest(".product"),e=i.find(".yith-wcpb-product-bundled-item-image .price").first(),n=e.find("ins"),a=e.find("del"),r=i.find(".yith-wcpb-product-bundled-item-image-wrapper img").first(),c=r.attr("src");"undefined"!=typeof c&&c.length>0&&r.attr("srcset",c),n.html(""),a.html("")}),p.trigger("check_variations"),p.trigger("update_variation_values")})},t(document).on("yith_wcpb_add_to_cart_init",function(){t(".yith-wcpb-bundle-form").yith_bundle_form()}).trigger("yith_wcpb_add_to_cart_init"),t(document).on("qv_loader_stop",function(){t(document).trigger("yith_wcpb_add_to_cart_init")})});