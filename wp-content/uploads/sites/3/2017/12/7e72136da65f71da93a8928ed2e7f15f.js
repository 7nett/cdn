/**handles:wdcp_facebook**/
!function(o){o(function(){function e(e){o.post(_wdcp_ajax_url,e,function(e){o(document).trigger("wdcp_comment_sent",["facebook"]),window.location.reload()})}o(document).bind("wdcp_facebook_login_attempt",function(){FB.login(function(e){e.authResponse&&e.authResponse.userID&&o(document).trigger("wdcp_logged_in",["facebook"])},{scope:"email"})}),o("#login-with-facebook").length&&"undefined"!=typeof FB&&FB.getLoginStatus(function(e){e.authResponse&&e.authResponse.userID&&o(document).trigger("wdcp_logged_in",["facebook",!0])}),o(document).on("click","#comment-provider-facebook a.comment-provider-logout",function(){var e=o(this).attr("href");return o.post(_wdcp_ajax_url,{action:"wdcp_facebook_logout"},function(o){FB.logout(function(o){window.location.reload()})}),!1}),o(document).on("click","#send-facebook-comment",function(){var t=o("#facebook-comment").val(),n=!!o("#post-on-facebook").is(":checked"),c=o("#comment_parent").val(),i=o("#subscribe").length&&o("#subscribe").is(":checked")?"subscribe":"",a={action:"wdcp_post_facebook_comment",post_id:_wdcp_data.post_id,post_on_facebook:0,comment_parent:c,subscribe:i,comment:t};return o(document).trigger("wdcp_preprocess_comment_data",[a]),o(this).parents(".comment-provider").empty().append('<div class="comment-provider-waiting-response"></div>'),n?FB.login(function(o){if(!o.authResponse)return!1;if(!o.authResponse.grantedScopes)return!1;var t=!!o.authResponse.grantedScopes.match(/publish_actions/);a.post_on_facebook=t?1:0,e(a)},{scope:"publish_actions",return_scopes:!0}):e(a),!1}),o('[class*="comment"] a[href*="facebook.com/profile.php?id="]').each(function(){var o=jQuery(this),e=o.attr("href"),t=!(!e||!e.length)&&e.split("?id=");return!t||void o.attr("href","https://facebook.com/"+t[1])})})}(jQuery);